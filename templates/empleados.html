{% extends "layout.html" %} {% block content %}

<h2 class="mb-4">Gestión de Empleados</h2>

<!-- Formulario para agregar empleado -->
<div class="card shadow-sm mb-4">
  <div class="card-body">
    <h5 class="mb-3">Registrar Nuevo Empleado</h5>

    <form action="/empleados/nuevo" method="POST" class="row g-3">
      <div class="col-md-6">
        <label class="form-label" for="nombre">Nombre</label>
        <input
          id="nombre"
          name="nombre"
          class="form-control"
          required
          placeholder="Nombre completo"
        />
      </div>

      <div class="col-md-6">
        <label class="form-label" for="puesto">Puesto</label>
        <input
          id="puesto"
          name="puesto"
          class="form-control"
          required
          placeholder="Ej: Vendedor, Supervisor"
        />
      </div>

      <div class="col-md-6">
        <label class="form-label" for="telefono">Teléfono</label>
        <input
          id="telefono"
          name="telefono"
          class="form-control"
          placeholder="5551234567"
        />
      </div>

      <div class="col-md-6">
        <label class="form-label" for="correo">Correo</label>
        <input
          id="correo"
          name="correo"
          type="email"
          class="form-control"
          placeholder="correo@ejemplo.com"
        />
      </div>

      <div class="col-md-6">
        <label class="form-label" for="usuario">Usuario</label>
        <input
          id="usuario"
          name="usuario"
          class="form-control"
          required
          placeholder="Nombre de usuario"
        />
      </div>

      <div class="col-md-6">
        <label class="form-label" for="password">Contraseña</label>
        <input
          id="password"
          type="password"
          name="password"
          class="form-control"
          required
          placeholder="Contraseña"
        />
      </div>

      <div class="col-md-6">
        <label for="rol" class="form-label">Rol</label>
        <select id="rol" name="rol" class="form-select" required>
          <option value="Vendedor">Vendedor</option>
          <option value="Admin">Administrador</option>
        </select>
      </div>

      <div class="col-12">
        <button type="submit" class="btn btn-success w-100">Registrar Empleado</button>
      </div>
    </form>
  </div>
</div>

<!-- Filtros de búsqueda -->
<form method="GET" action="/empleados/" class="row g-3 mb-4">

  <!-- Buscar por nombre, puesto, correo -->
  <div class="col-md-6">
    <input 
      type="text" 
      name="buscar" 
      class="form-control"
      placeholder="Buscar por nombre, puesto o correo"
      value="{{ buscar }}"
    />
  </div>

  <!-- Filtrar por Rol -->
  <div class="col-md-3">
    <select name="rol" class="form-select" title="Rol">
      <option value="">-- Rol --</option>
      <option value="Vendedor" {% if rol == 'Vendedor' %}selected{% endif %}>Vendedor</option>
      <option value="Admin" {% if rol == 'Admin' %}selected{% endif %}>Administrador</option>
    </select>
  </div>

  <!-- Filtrar por Estado -->
  <div class="col-md-3">
    <select name="estado" class="form-select" title="Estado">
      <option value="">-- Estado --</option>
      <option value="Activo" {% if estado == 'Activo' %}selected{% endif %}>Activo</option>
      <option value="Inactivo" {% if estado == 'Inactivo' %}selected{% endif %}>Inactivo</option>
    </select>
  </div>

  <div class="col-12">
    <button class="btn btn-primary w-100" type="submit">
      Buscar / Filtrar
    </button>
  </div>

</form>


<!-- Tabla de empleados -->
<div class="card shadow-sm">
  <div class="card-body">
    <h5 class="mb-3">Listado de Empleados</h5>

    <table class="table table-bordered table-striped">
      <thead class="table-primary">
        <tr>
          <th>ID</th>
          <th>Nombre</th>
          <th>Puesto</th>
          <th>Teléfono</th>
          <th>Correo</th>
          <th>Rol</th>
          <th>Acciones</th>
        </tr>
      </thead>

      <tbody>
        {% for emp in empleados %}
        <tr>
          <td>{{ emp.idempleado }}</td>
          <td>{{ emp.nombre }}</td>
          <td>{{ emp.puesto }}</td>
          <td>{{ emp.telefono }}</td>
          <td>{{ emp.correo }}</td>
          <td>{{ emp.rol }}</td>
          <td>
            {% if emp.estado == 'Activo' %}
            <a
              class="btn btn-warning btn-sm"
              href="/empleados/estado/{{ emp.idempleado }}/Inactivo"
              >Desactivar</a
            >
            {% else %}
            <a
              class="btn btn-success btn-sm"
              href="/empleados/estado/{{ emp.idempleado }}/Activo"
              >Activar</a
            >
            {% endif %}
            <a
              href="/empleados/detalle/{{ emp.idempleado }}"
              class="btn btn-info btn-sm me-1"
            >
              Editar
            </a>
            <a
              href="/empleados/eliminar/{{ emp.idempleado }}"
              class="btn btn-danger btn-sm"
              onclick="return confirm('¿Eliminar este empleado?')"
            >
              Eliminar
            </a>
            
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
